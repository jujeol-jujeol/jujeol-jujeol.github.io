---
layout: post
title: '[BE] ë¡œê·¸ ìœ ë¬´ì— ë”°ë¥¸ ì„±ëŠ¥ ì¸¡ì •'
description: >
    Apache JMeterë¥¼ í†µí•´ ì„±ëŠ¥ ì¸¡ì •í•˜ê¸°
tags: [jojal-jojal]
author: solong
---

# ë¡œê·¸ ìœ ë¬´ì— ë”°ë¥¸ ì„±ëŠ¥ ì¸¡ì •

## JMeter

JMeter ëŠ” ì„±ëŠ¥ ì¸¡ì •ì„ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤ì´ë‹¤. ì˜¤í”ˆì†ŒìŠ¤ ì¤‘ì—ì„œëŠ” í•­ìƒ TOP7ì— ë­í¬ë  ì •ë„ë¡œ ë§ì´ ì‚¬ìš©í•œë‹¤. ìˆœìˆ˜ ìë°” ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ë©° ì •ì , ë™ì , ì›¹ ë™ì  ì–´í”Œë¦¬ì¼€ì´ì…˜ í…ŒìŠ¤íŒ… ëª¨ë‘ ê°€ëŠ¥í•˜ë‹¤. [Apache JMeter ê³µì‹ ë¬¸ì„œ](https://jmeter.apache.org/) ì— ë”°ë¥´ë©´,

- Web - HTTP, HTTPS (Java, NodeJS, PHP, ASP.NET, â€¦)
- SOAP / REST Webservices
- FTP
- Database via JDBC
- LDAP
- Message-oriented middleware (MOM) via JMS
- Mail - SMTP(S), POP3(S) and IMAP(S)
- Native commands or shell scripts
- TCP
- Java Objects

ìœ„ì™€ ê°™ì´ ë‹¤ì–‘í•œ ì–´í”Œë¦¬ì¼€ì´ì…˜, ì„œë²„, í”„ë¡œí† ì½œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ëŒ€ê·œëª¨ í…ŒìŠ¤íŠ¸ì—ëŠ” ì¢€ ë¶ˆë¦¬í•˜ë‹¤ê³  í•œë‹¤ğŸ¤”  ê·¸ë˜ë„ ì—¬ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì„ ì§€ì›í•œë‹¤ëŠ” ì¥ì ë„ ìˆë‹¤.

([ì°¸ê³ 1](https://testguild.com/load-testing-tools/), [ì°¸ê³ 2](https://jybaek.tistory.com/889))

### JMeter ì„¤ì¹˜
ì•„ë˜ ì„¤ì¹˜ ë°©ë²•ì€ Mac OS ê¸°ì¤€ì´ë‹¤.

```bash
$ brew install jmeter
```

### JMeter ì‹¤í–‰

```bash
$ open /opt/homebrew/Cellar/jmeter/5.4.1/bin/jmeter

# ì°¾ì•„ë³´ë©´ ë³´í†µ ì•„ë˜ì²˜ëŸ¼ í•˜ë¼ëŠ”ë° ë‚˜ëŠ” brew ìœ„ì¹˜ê°€ ë‹¬ë¼ì„œ ì•Œì•„ì„œ ì°¾ì•„ì„œ í–ˆë‹¤.
$ open /usr/local/bin/jmeter
```

### plugin ì„¤ì¹˜

Options â†’ Plugin Manager

Available Plugin íƒ­ì—ì„œ

- 3 Basic Graphs
- Custom Thread Groups

ë‘ ê°œë¥¼ ì„¤ì¹˜í•œë‹¤.

### ThreadGroup ìƒì„± ë° ì¸¡ì •

![jmeter01](/assets/img/jmeter/JMeter_01.png)

ì—¬ëŸ¬ ê°œì˜ ìŠ¤ë ˆë“œ ê·¸ë£¹ì„ ë§Œë“¤ì–´ì„œ ì‹¤í–‰í•´ ë³¼ ìˆ˜ ìˆë‹¤. JMeter ì˜ ì‹¤í–‰ ë‹¨ìœ„ê°€ ì´ ìŠ¤ë ˆë“œ ê·¸ë£¹ì´ë‹¤.

í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œ ê·¸ë£¹ì— ì—¬ëŸ¬ ê°œì˜ HTTP Request ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ, ë‚˜ëŠ” ê°™ì€ ìš”ì²­ì„ ì—¬ëŸ¬ í˜•íƒœë¡œ ë³´ì¡´í•˜ê³  ì‹¶ì—ˆê¸° ë•Œë¬¸ì— ë”°ë¡œ ë§Œë“¤ì—ˆë‹¤.

![jmeter02](/assets/img/jmeter/JMeter_02.png)

ê²°ê³¼ë¥¼ ì—¬ëŸ¬ í˜•íƒœì˜ ë¦¬ìŠ¤ë„ˆë¡œ ë³¼ ìˆ˜ ìˆë‹¤.

ë‚˜ëŠ” ê·¸ ì¤‘ì—ì„œ ìš”ì²­ì„ í•˜ë‚˜ì”© ë³¼ ìˆ˜ ìˆëŠ” `View Results Tree` ì™€ TPS ë“±ì„ ìš”ì•½í•´ì„œ ë³´ì—¬ì£¼ëŠ” `Summary Report` , ê°™ì€ ì •ë³´ë¥¼ ê·¸ë˜í”„ë¡œ í‘œí˜„í•˜ëŠ” `Graph Results` ì„¸ ê°œë§Œ ë³¼ ê²ƒì´ë‹¤.

![jmeter03](/assets/img/jmeter/JMeter_03.png)

`Thread Group` ì€ ì•„ë˜ì™€ ê°™ì´ ìŠ¤ë ˆë“œ ìˆ˜ë§Œ ë³€ê²½í•œë‹¤.

`Numbers of Threads (users)` ê°€ ë§ ê·¸ëŒ€ë¡œ ìŠ¤ë ˆë“œ ìˆ˜, ìš”ì²­í•˜ëŠ” ì‚¬ìš©ìì˜ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì•„ë˜ëŠ” ì–´ëŠì •ë„ ì‹œê°„ ê°„ê²©ìœ¼ë¡œ í• ê±°ëƒ, ë°˜ë³µí• ê±°ëƒ ì´ëŸ°ê±´ë° ì˜µì…˜ì„ ë°”ê¿”ê°€ë©° ì£¼ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.

![jmeter04](/assets/img/jmeter/JMeter_04.png)

ê·¸ë¦¬ê³  HTTP Request ì— ë‹¤ìŒê³¼ ê°™ì´ ìš”ì²­ ë³´ë‚¼ ê³³ ì •ë³´ë¥¼ ì…ë ¥í•œë‹¤.

![jmeter05](/assets/img/jmeter/JMeter_05.png)

ì§€ê¸ˆì€ ë‹¨ìˆœ ì¡°íšŒ í…ŒìŠ¤íŠ¸ë¼ ë‚´ìš©ì´ ë§ì§€ ì•Šì€ë°, POST ìš”ì²­ ë“±ì—ì„œ body ê°’ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤.

ê·¸ë¦¬ê³  Start ë¥¼ ëˆ„ë¥´ë©´ ë~!ğŸ•º

## ì„±ëŠ¥ ì¸¡ì •

### ì„±ëŠ¥ ì¸¡ì • ëŒ€ìƒ

ìš°ë¦¬ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ í¬ê²Œ ë‘ ê°€ì§€ ë¡œê·¸ë¥¼ ì¶œë ¥í•œë‹¤.

- Logback ì„ ì‚¬ìš©í•œ ë¡œê·¸
- P6spy ë¥¼ ì‚¬ìš©í•œ SQL ì¿¼ë¦¬ ë¡œê·¸

Logback ì„ ì‚¬ìš©í•œ ë¡œê·¸ì˜ ê²½ìš°, ê°œë°œ ì„œë²„ëŠ” `INFO` ë ˆë²¨, ìš´ì˜ ì„œë²„ëŠ” `WARN` ë ˆë²¨ë¡œ ì¶œë ¥í•˜ê³  ìˆë‹¤. ì—¬ê¸°ì— ë”í•´ `LogAOP` ë¼ëŠ” ë³„ë„ ì„¤ì •ì„ í†µí•´ ë‹¤ì–‘í•œ í˜•íƒœì˜ ë¡œê·¸ í¬ë§·ì„ ë§Œë“¤ì—ˆë‹¤.

1. `500` ëŒ€ ì—ëŸ¬ì˜ ê²½ìš° StackTraceë¥¼ ì¶œë ¥í•œë‹¤.
2. ì»¨íŠ¸ë¡¤ëŸ¬ë‹¨ë¶€í„° ëª¨ë“  ë ˆì´ì–´ì˜ ëª¨ë“  ë©”ì„œë“œì— ëŒ€í•œ ë¡œê·¸ë¥¼ ì¶œë ¥í•œë‹¤. ì´ ë¡œê·¸ë€ íŒŒë¼ë¯¸í„°, ë©”ì„œë“œê°€ ìˆ˜í–‰ë˜ëŠ” ì‹œê·¸ë‹ˆì²˜(í´ë˜ìŠ¤ì™€ ë©”ì„œë“œëª…), ë°˜í™˜ê°’ì„ ë§í•œë‹¤.
3. ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ íŠ¹ì • ë©”ì„œë“œ ìˆ˜í–‰ì— ì†Œìš”ë˜ëŠ” ì‹œê°„ì„ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.

ê·¸ë¦¬ê³  Logback ì„¤ì • íŒŒì¼ì—ì„œëŠ” ì‹œê°„, ìŠ¤ë ˆë“œ ë“±ì„ í‘œì‹œí•˜ë©° HTTP Request&Response ì„¤ì •ë„ ë³„ë„ë¡œ í•´ ë‘” ìƒíƒœì´ë‹¤.

### LogAOP `X`, P6spy `O` (ê°œë°œ ì„œë²„)

![jmeter06](/assets/img/jmeter/JMeter_06.png)

![jmeter07](/assets/img/jmeter/JMeter_07.png)

### LogAOP `X`, P6spy `O`

![jmeter08](/assets/img/jmeter/JMeter_08.png)

![jmeter09](/assets/img/jmeter/JMeter_09.png)

### LogAOP `O`, P6spy `X`

![jmeter10](/assets/img/jmeter/JMeter_10.png)

![jmeter11](/assets/img/jmeter/JMeter_11.png)

### LogAOP `X`, P6spy `X` (ìš´ì˜ ì„œë²„)

![jmeter12](/assets/img/jmeter/JMeter_12.png)

![jmeter13](/assets/img/jmeter/JMeter_13.png)

## ê²°ë¡ 

ì½˜ì†” ì¶œë ¥ì´ ê½¤ ë§ì€ ì‹œê°„ì„ ì¡ì•„ë¨¹ëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆë‹¤. ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ìš´ì˜ ë²„ì „ì—ëŠ” ì—ëŸ¬ ì¶œë ¥ ì´ì™¸ì˜ ëª¨ë“  ë¡œê·¸ë¥¼ ì œì™¸í–ˆë‹¤.